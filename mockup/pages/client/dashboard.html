<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard - QCrypto Client Panel</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;400;500;600;700;800&family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet"><link rel="stylesheet" href="../../assets/css/reset.css"><link rel="stylesheet" href="../../assets/css/variables.css"><link rel="stylesheet" href="../../assets/css/global.css"><link rel="stylesheet" href="../../assets/css/layout.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <div class="layout">
    <!-- Sidebar Navigation (Loaded Dynamically) -->
    <aside class="layout-sidebar">
  <div class="sidebar-logo">
    <span class="sidebar-logo-text">QCrypto</span>
  </div>

  <nav class="sidebar-nav">
    <div class="sidebar-nav-section">
      <div class="sidebar-nav-section-title">Client</div>
      <a href="dashboard.html" class="sidebar-nav-item" data-page="dashboard">
        <span class="sidebar-nav-icon">üìä</span>
        <span class="sidebar-nav-text">Dashboard</span>
      </a>
      <a href="wallets.html" class="sidebar-nav-item" data-page="wallets">
        <span class="sidebar-nav-icon">üíº</span>
        <span class="sidebar-nav-text">Wallets</span>
      </a>
      <a href="transactions.html" class="sidebar-nav-item" data-page="transactions">
        <span class="sidebar-nav-icon">üìù</span>
        <span class="sidebar-nav-text">Transactions</span>
        <span class="sidebar-nav-badge">3</span>
      </a>
      <a href="address-book.html" class="sidebar-nav-item" data-page="address-book">
        <span class="sidebar-nav-icon">üìñ</span>
        <span class="sidebar-nav-text">Address Book</span>
      </a>
      <a href="deposit.html" class="sidebar-nav-item" data-page="deposit">
        <span class="sidebar-nav-icon">‚¨áÔ∏è</span>
        <span class="sidebar-nav-text">Deposit</span>
      </a>
      <a href="withdraw.html" class="sidebar-nav-item" data-page="withdraw">
        <span class="sidebar-nav-icon">‚¨ÜÔ∏è</span>
        <span class="sidebar-nav-text">Withdraw</span>
      </a>
      <a href="staking.html" class="sidebar-nav-item" data-page="staking">
        <span class="sidebar-nav-icon">‚ö°</span>
        <span class="sidebar-nav-text">Staking</span>
      </a>
      <a href="settlement.html" class="sidebar-nav-item" data-page="settlement">
        <span class="sidebar-nav-icon">üèõÔ∏è</span>
        <span class="sidebar-nav-text">Settlement</span>
      </a>
    </div>

    <div class="sidebar-nav-section">
          <div class="sidebar-nav-section-title">Admin</div>
          <a href="../admin/admin-overview.html" class="sidebar-nav-item" data-page="admin-overview">
            <span class="sidebar-nav-icon">üìä</span>
            <span class="sidebar-nav-text">Overview</span>
          </a>
          <a href="../admin/admin-clients.html" class="sidebar-nav-item" data-page="admin-clients">
            <span class="sidebar-nav-icon">üë•</span>
            <span class="sidebar-nav-text">Clients</span>
          </a>
          <a href="../admin/admin-users.html" class="sidebar-nav-item" data-page="admin-users">
            <span class="sidebar-nav-icon">üë§</span>
            <span class="sidebar-nav-text">Users</span>
          </a>
          <a href="../admin/admin-crypto.html" class="sidebar-nav-item" data-page="admin-crypto">
            <span class="sidebar-nav-icon">ü™ô</span>
            <span class="sidebar-nav-text">Crypto</span>
          </a>
          <a href="../admin/admin-commissions.html" class="sidebar-nav-item" data-page="admin-commissions">
            <span class="sidebar-nav-icon">üí∞</span>
            <span class="sidebar-nav-text">Commissions</span>
          </a>
          <a href="../admin/admin-settlement.html" class="sidebar-nav-item" data-page="admin-settlement">
            <span class="sidebar-nav-icon">üèõÔ∏è</span>
            <span class="sidebar-nav-text">Settlement</span>
          </a>
          <a href="../admin/admin-compliance.html" class="sidebar-nav-item" data-page="admin-compliance">
            <span class="sidebar-nav-icon">üìú</span>
            <span class="sidebar-nav-text">Compliance</span>
          </a>
          <a href="../admin/admin-administration.html" class="sidebar-nav-item" data-page="admin-administration">
            <span class="sidebar-nav-icon">‚öôÔ∏è</span>
            <span class="sidebar-nav-text">Administration</span>
          </a>
        </div>

    <div class="sidebar-nav-section">
      <div class="sidebar-nav-section-title">AIFM</div>
      <a href="../aifm/aifm-dashboard.html" class="sidebar-nav-item" data-page="aifm-dashboard">
        <span class="sidebar-nav-icon">üè¶</span>
        <span class="sidebar-nav-text">AIFM Dashboard</span>
      </a>
      <a href="../aifm/fund-manager-dashboard.html" class="sidebar-nav-item" data-page="fund-manager-dashboard">
        <span class="sidebar-nav-icon">üíº</span>
        <span class="sidebar-nav-text">Fund Manager</span>
      </a>
      <a href="../aifm/trader-dashboard.html" class="sidebar-nav-item" data-page="trader-dashboard">
        <span class="sidebar-nav-icon">üíπ</span>
        <span class="sidebar-nav-text">Trader</span>
      </a>
    </div>

    <div class="sidebar-nav-section">
      <div class="sidebar-nav-section-title">Operations</div>
      <a href="../aifm/middle-office-dashboard.html" class="sidebar-nav-item" data-page="middle-office-dashboard">
        <span class="sidebar-nav-icon">üìã</span>
        <span class="sidebar-nav-text">Middle Office</span>
      </a>
      <a href="../aifm/depositary-dashboard.html" class="sidebar-nav-item" data-page="depositary-dashboard">
        <span class="sidebar-nav-icon">üè¶</span>
        <span class="sidebar-nav-text">Depositary</span>
      </a>
    </div>

    <div class="sidebar-nav-section">
      <div class="sidebar-nav-section-title">Settings</div>
      <a href="security.html" class="sidebar-nav-item" data-page="security">
        <span class="sidebar-nav-icon">üîí</span>
        <span class="sidebar-nav-text">Security</span>
      </a>
      <a href="profile.html" class="sidebar-nav-item" data-page="profile">
        <span class="sidebar-nav-icon">üë§</span>
        <span class="sidebar-nav-text">Profile</span>
      </a>
    </div>
  </nav>
</aside>


    <!-- Main Content -->
    <main class="layout-main">
      <!-- Top Bar -->
      <header class="topbar">
        <div class="topbar-left">
          <button class="btn btn-secondary btn-sm">‚ò∞</button>
        </div>

        <div class="topbar-center">
        </div>

        <div class="topbar-right">
          <div class="notification-icon">
            <span>üîî</span>
            <span class="notification-count">5</span>
          </div>

          <div class="user-menu">
            <div class="user-avatar">JD</div>
            <div class="user-info">
              <div class="user-name">John Doe</div>
              <div class="user-role">Retail Client</div>
            </div>
          </div>
        </div>
      </header>

      <!-- Page Content -->
      <div class="content-container">
        <!-- Stats Grid -->
        <div class="grid-4 mb-8">
          <div class="stat-card">
            <div class="stat-card-label">Total Portfolio</div>
            <div class="stat-card-value">‚Ç¨187,456.75</div>
            <div class="stat-card-change positive">
              <span>‚ñ≤</span>
              <span>+2.5% from last month</span>
            </div>
          </div>

          <div class="stat-card">
            <div class="stat-card-label">Fiat Balance</div>
            <div class="stat-card-value" style="color: var(--danger);">-‚Ç¨329,456.83</div>
            <div class="stat-card-secondary" style="font-size: 0.75rem; margin-top: 4px;">Limit: ‚Ç¨5,000,000.00</div>
          </div>

          <div class="stat-card">
            <div class="stat-card-label">Crypto Assets</div>
            <div class="stat-card-value">‚Ç¨186,966.75</div>
            <div class="stat-card-change positive">
              <span>‚ñ≤</span>
              <span>+3.1% (24h)</span>
            </div>
          </div>

          <div class="stat-card">
            <div class="stat-card-label">Locked in Staking</div>
            <div class="stat-card-value">‚Ç¨13,478.40</div>
            <div class="stat-card-secondary">4.8 ETH Staking</div>
          </div>
        </div>

        <!-- Total Balance Graph -->
        <div class="card mb-8">
          <div class="card-header" style="display: flex; justify-content: space-between; align-items: center;">
            <h2 class="card-title">Total Balance History</h2>
            <div class="time-filters">
              <button class="btn btn-xs btn-outline-secondary">7D</button>
              <button class="btn btn-xs btn-primary">30D</button>
              <button class="btn btn-xs btn-outline-secondary">90D</button>
              <button class="btn btn-xs btn-outline-secondary">YTD</button>
            </div>
          </div>
          <div style="height: 300px; width: 100%;">
            <canvas id="balanceChart"></canvas>
          </div>
        </div>

        <!-- Main Content Grid -->
        <div class="grid-2 mb-8">
          <!-- Portfolio Distribution -->
          <div class="card">
            <div class="card-header">
              <h2 class="card-title">Crypto Portfolio Distribution</h2>
            </div>
            <div style="height: 300px; display: flex; align-items: center; justify-content: center;">
              <canvas id="portfolioChart"></canvas>
            </div>
            <div style="margin-top: var(--space-4);">
              <div style="display: grid; grid-template-columns: 1fr 1fr; gap: var(--space-3);">
                <div style="display: flex; justify-content: space-between;">
                  <div style="display: flex; align-items: center; gap: var(--space-2);">
                    <span style="width: 12px; height: 12px; background-color: #F7931A; border-radius: 2px;"></span>
                    <span>BTC</span>
                  </div>
                  <span class="font-semibold">45%</span>
                </div>
                <div style="display: flex; justify-content: space-between;">
                  <div style="display: flex; align-items: center; gap: var(--space-2);">
                    <span style="width: 12px; height: 12px; background-color: #627EEA; border-radius: 2px;"></span>
                    <span>ETH</span>
                  </div>
                  <span class="font-semibold">25%</span>
                </div>
                <div style="display: flex; justify-content: space-between;">
                  <div style="display: flex; align-items: center; gap: var(--space-2);">
                    <span style="width: 12px; height: 12px; background-color: #E84142; border-radius: 2px;"></span>
                    <span>AVAX</span>
                  </div>
                  <span class="font-semibold">10%</span>
                </div>
                <div style="display: flex; justify-content: space-between;">
                  <div style="display: flex; align-items: center; gap: var(--space-2);">
                    <span style="width: 12px; height: 12px; background-color: #8247E5; border-radius: 2px;"></span>
                    <span>POL</span>
                  </div>
                  <span class="font-semibold">10%</span>
                </div>
                <div style="display: flex; justify-content: space-between;">
                  <div style="display: flex; align-items: center; gap: var(--space-2);">
                    <span style="width: 12px; height: 12px; background-color: #2775CA; border-radius: 2px;"></span>
                    <span>USDC</span>
                  </div>
                  <span class="font-semibold">5%</span>
                </div>
                <div style="display: flex; justify-content: space-between;">
                  <div style="display: flex; align-items: center; gap: var(--space-2);">
                    <span style="width: 12px; height: 12px; background-color: #00D1FF; border-radius: 2px;"></span>
                    <span>KULA</span>
                  </div>
                  <span class="font-semibold">5%</span>
                </div>
              </div>
            </div>
          </div>

          <!-- Recent Activity -->
          <div class="card">
            <div class="card-header">
              <h2 class="card-title">Recent Activity</h2>
            </div>
            <div>
              <div style="padding: var(--space-4); border-bottom: 1px solid var(--border-light);">
                <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: var(--space-2);">
                  <div>
                    <div class="font-semibold">Deposit Confirmed</div>
                    <div style="font-size: var(--text-sm); color: var(--text-secondary);">Bitcoin</div>
                  </div>
                  <span class="badge badge-success">Completed</span>
                </div>
                <div style="font-size: var(--text-sm); color: var(--text-tertiary);">2 hours ago</div>
              </div>

              <div style="padding: var(--space-4); border-bottom: 1px solid var(--border-light);">
                <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: var(--space-2);">
                  <div>
                    <div class="font-semibold">Staking Reward</div>
                    <div style="font-size: var(--text-sm); color: var(--text-secondary);">Ethereum</div>
                  </div>
                  <span class="badge badge-info">Received</span>
                </div>
                <div style="font-size: var(--text-sm); color: var(--text-tertiary);">5 hours ago</div>
              </div>

              <div style="padding: var(--space-4);">
                <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: var(--space-2);">
                  <div>
                    <div class="font-semibold">Withdrawal Pending</div>
                    <div style="font-size: var(--text-sm); color: var(--text-secondary);">Ethereum</div>
                  </div>
                  <span class="badge badge-warning">Pending</span>
                </div>
                <div style="font-size: var(--text-sm); color: var(--text-tertiary);">1 day ago</div>
              </div>
            </div>
            <div style="text-align: center; margin-top: var(--space-4);">
              <a href="transactions.html" class="text-link">View all transactions ‚Üí</a>
            </div>
          </div>
        </div>

        <!-- Quick Actions -->
        <div class="card">
          <div class="card-header">
            <h2 class="card-title">Quick Actions</h2>
          </div>
          <div class="grid-4">
            <a href="wallets.html" class="quick-action-card">
              <div class="quick-action-content">
                <div class="quick-action-title">Wallets</div>
                <div class="quick-action-desc">Manage assets</div>
              </div>
            </a>

            <a href="trading.html" class="quick-action-card">
              <div class="quick-action-content">
                <div class="quick-action-title">Trading</div>
                <div class="quick-action-desc">Buy & Sell</div>
              </div>
            </a>

            <a href="settlement.html" class="quick-action-card">
              <div class="quick-action-content">
                <div class="quick-action-title">Settle</div>
                <div class="quick-action-desc">Clear fiat balance</div>
              </div>
            </a>

            <a href="staking.html" class="quick-action-card">
              <div class="quick-action-content">
                <div class="quick-action-title">Stake</div>
                <div class="quick-action-desc">Earn rewards</div>
              </div>
            </a>
          </div>
        </div>

        <style>
          .quick-action-card {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: var(--space-4);
            background-color: var(--bg-primary);
            border: 1px solid var(--border-light);
            border-radius: var(--radius-lg);
            transition: all var(--transition-fast);
            text-decoration: none;
            cursor: pointer;
            height: 100%;
            position: relative;
            overflow: hidden;
          }

          .quick-action-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: var(--gradient-primary);
            opacity: 0;
            transition: opacity var(--transition-fast);
          }

          .quick-action-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
            border-color: transparent;
          }

          .quick-action-card:hover::before {
            opacity: 1;
          }

          .quick-action-content {
            text-align: center;
          }

          .quick-action-title {
            font-size: var(--text-lg);
            font-weight: var(--font-semibold);
            color: var(--text-primary);
            margin-bottom: var(--space-1);
          }

          .quick-action-desc {
            font-size: var(--text-sm);
            color: var(--text-secondary);
          }
        </style>
      </div>
    </main>
  </div>  <script src="../../assets/js/nav-active.js"></script>

  <script src="../../assets/js/app.js"></script>

  <script>
    // Chart.js Implementation
    document.addEventListener('DOMContentLoaded', function() {
      
      // --- Total Balance Line Chart ---
      const balanceCtx = document.getElementById('balanceChart').getContext('2d');
      let balanceChart;

      // Helper to generate data with specific volatility
      function generateData(days) {
        const labels = [];
        const dataPoints = [];
        let currentValue = 180000; // Starting base value
        
        // We want the *end* value to be around the current portfolio value (~187k)
        // So we'll generate backwards or just generate and then scale? 
        // Let's generate forward from a start date.
        
        // To make it look realistic ending at ~187k, let's work backwards from today
        let value = 187456.75;

        for (let i = 0; i < days; i++) {
          const date = new Date();
          date.setDate(date.getDate() - i);
          labels.unshift(date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' }));
          
          dataPoints.unshift(value);

          // Reverse calculation for previous day: 
          // value = prevValue * (1 + change)  =>  prevValue = value / (1 + change)
          // Change between -0.1% (-0.001) and +0.3% (+0.003)
          const change = (Math.random() * 0.004) - 0.001; 
          value = value / (1 + change);
        }
        
        return { labels, dataPoints };
      }

      function initChart(days) {
        const data = generateData(days);

        if (balanceChart) {
          balanceChart.destroy();
        }

        // Create gradient
        const gradient = balanceCtx.createLinearGradient(0, 0, 0, 400);
        gradient.addColorStop(0, 'rgba(67, 24, 255, 0.2)'); // Brand Primary with opacity
        gradient.addColorStop(1, 'rgba(67, 24, 255, 0)');

        balanceChart = new Chart(balanceCtx, {
          type: 'line',
          data: {
            labels: data.labels,
            datasets: [{
              label: 'Total Balance (EUR)',
              data: data.dataPoints,
              borderColor: '#4318FF', // Brand Primary
              backgroundColor: gradient,
              borderWidth: 3,
              fill: true,
              tension: 0.4, // Smooth curves
              pointRadius: 0,
              pointHoverRadius: 6,
              pointHoverBackgroundColor: '#4318FF',
              pointHoverBorderColor: '#fff',
              pointHoverBorderWidth: 2
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
              legend: {
                display: false
              },
              tooltip: {
                mode: 'index',
                intersect: false,
                backgroundColor: '#1B2559',
                titleColor: '#fff',
                bodyColor: '#fff',
                padding: 12,
                cornerRadius: 8,
                displayColors: false,
                callbacks: {
                  label: function(context) {
                    return '‚Ç¨' + context.parsed.y.toLocaleString(undefined, {minimumFractionDigits: 2, maximumFractionDigits: 2});
                  }
                }
              }
            },
            scales: {
              x: {
                grid: {
                  display: false,
                  drawBorder: false
                },
                ticks: {
                  maxTicksLimit: 8,
                  color: '#A3AED0', // Secondary Text
                  font: {
                    family: "'DM Sans', sans-serif",
                    size: 12
                  }
                }
              },
              y: {
                grid: {
                  display: true,
                  drawBorder: false,
                  color: '#E0E5F2', // Light Border
                  borderDash: [5, 5]
                },
                ticks: {
                  color: '#A3AED0', // Secondary Text
                  font: {
                    family: "'DM Sans', sans-serif",
                    size: 12
                  },
                  callback: function(value) {
                    return '‚Ç¨' + (value / 1000).toFixed(0) + 'k';
                  }
                }
              }
            },
            interaction: {
              mode: 'nearest',
              axis: 'x',
              intersect: false
            }
          }
        });
      }

      // Initialize with 30 days
      initChart(30);

      // Time Filter Logic
      const buttons = document.querySelectorAll('.time-filters button');
      buttons.forEach(btn => {
        btn.addEventListener('click', (e) => {
          // Update active state
          buttons.forEach(b => {
            b.classList.remove('btn-primary');
            b.classList.add('btn-outline-secondary');
          });
          e.target.classList.remove('btn-outline-secondary');
          e.target.classList.add('btn-primary');

          // Update Chart
          const timeText = e.target.innerText;
          let days = 30;
          if (timeText === '7D') days = 7;
          if (timeText === '30D') days = 30;
          if (timeText === '90D') days = 90;
          if (timeText === 'YTD') days = 180; // Approx YTD for mockup
          
          initChart(days);
        });
      });


      // --- Portfolio Distribution Pie Chart ---
      const portfolioCtx = document.getElementById('portfolioChart').getContext('2d');
      
      new Chart(portfolioCtx, {
        type: 'doughnut',
        data: {
          labels: ['Bitcoin (BTC)', 'Ethereum (ETH)', 'Avalanche (AVAX)', 'Polygon (POL)', 'USDC', 'Kula (KULA)'],
          datasets: [{
            data: [45, 25, 10, 10, 5, 5],
            backgroundColor: [
              '#F7931A', // BTC
              '#627EEA', // ETH
              '#E84142', // AVAX
              '#8247E5', // POL
              '#2775CA', // USDC
              '#00D1FF'  // KULA
            ],
            borderWidth: 0,
            hoverOffset: 4
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          cutout: '75%', // Thinner ring
          plugins: {
            legend: {
              display: false
            },
            tooltip: {
              backgroundColor: '#1B2559',
              padding: 12,
              cornerRadius: 8,
              callbacks: {
                label: function(context) {
                  return context.label + ': ' + context.parsed + '%';
                }
              }
            }
          }
        }
      });
    });
  </script>
</body>
</html>
